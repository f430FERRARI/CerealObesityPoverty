<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Cereal Obesity Poverty</title>
    <script src="https://d3js.org/d3.v3.min.js" charset="utf-8"></script> 
    <link href="https://fonts.googleapis.com/css?family=Raleway" rel="stylesheet">     
    <style> 
      
      body { 
        font-family: 'Raleway', sans-serif;
      } 

    </style>
  </head>
  <body>
    <script> 
      // Create main div
      var main = d3.select("body").append("div"); 

      // Create dropdown
      var select = main.append('select')  
        .attr('id', 'dropdown')
        .on('change',onchange);

      // Finds the column 

      // Render and create the chart
      function render(state, category, data){   
        // Filter for state
        data = data.filter(function(d) { return (d.LocationAbbr == state) && (d.StratificationCategoryId1 == category) }); 
        data = d3.nest().key(function(d){ return d.StratificationID1 }).entries(data);
        console.log(data);
      }  

      // Starting method. Read the csv
      d3.csv("obesity_survey_multiyear.csv", function(error, data) { 
        if (error) throw error;

        // Populate dropdown
        d3.select("#dropdown").selectAll("option")
          .data(d3.map(data, function(d){return d.StratificationCategoryId1;}).keys())
          .enter()
          .append("option")
          .text(function(d){return d;})
          .attr("value",function(d){return d;}); // TODO: Get full names for strat cat IDs


        render("AL", "GEN", data);
      });  


    </script>
  </body>
</html>